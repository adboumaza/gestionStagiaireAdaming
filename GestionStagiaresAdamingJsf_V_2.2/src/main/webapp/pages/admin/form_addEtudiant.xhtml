<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:b="http://bootsfaces.net/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions">

<ui:composition>
	<br> </br>
	<br> </br>
	<br> </br>
	<div class="well container">
		 <!-- exception add new Etudiant + message success+ error validation-->
	     <p:messages id="messages" showDetail="true" autoUpdate="true" closable="true" />	
		 <!-- Form validations -->  
		 <section class="wrapper">
		  <div class="row">
				<div class="col-lg-12">
					<ol class="breadcrumb">
						<h3 class="page-header"><i><h:graphicImage name="NiceAdmin/img/form.png"/> </i> Form Etudiant</h3>
					</ol>
				</div>
			</div>            
              <div class="row">
                  <div class="col-lg-12">
                      <section class="panel">
                          <header class="panel-heading">
                              Ajouter un étudiant
                          </header>
                          <div class="panel-body">
                              <div class="form">
                                  <h:form class="form-validate form-horizontal">
                                      <div class="form-group ">
                                          <label for="session" class="control-label col-lg-2">Session(En Cours) <span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <h:selectOneMenu  style="cursor:pointer;height:35px;width:25%;color:#797979;font-size:16px;" styleClass="selectpicker" required="true"
												requiredMessage="1 - session *"
												value="#{etudiantBean.idSession}">
												<f:selectItem itemLabel="Sélectionnez une session"
													itemValue="#{null}" noSelectionOption="true" />
											     <f:selectItems value="#{etudiantBean.sessionsEncours}" var="s"
													itemLabel="Session N°:#{s.idSession}, #{s.specialite.designation},Lieu : #{s.lieu}, Début:#{s.dateDebute}"
													itemValue="#{s.idSession}" />
											</h:selectOneMenu>
                                          </div>
                                      </div>
                                      <div class="form-group ">
                                          <label for="nom" class="control-label col-lg-2">Nom <span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <h:inputText requiredMessage="2 - Nom *" required="true" value="#{etudiantBean.nomEtudiant}" class="form-control" id="nom"  type="text" />
                                          </div>
                                      </div>
                                      <div class="form-group ">
                                          <label for="prenom" class="control-label col-lg-2">Prénom <span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <h:inputText requiredMessage="3 - Prénom *" required="true" value="#{etudiantBean.prenomEtudiant}" class="form-control" id="prenom"  type="text" />
                                          </div>
                                      </div>
                                      <div class="form-group ">
                                          <label for="adresse" class="control-label col-lg-2">Adresse <span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <h:inputText requiredMessage="4 - Adresse *" required="true" value="#{etudiantBean.adressePostal}" class="form-control" id="adresse"  type="text" />
                                          </div>
                                      </div>
                                      <div class="form-group ">
                                          <label for="codePostal" class="control-label col-lg-2">Code Postal <span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <h:inputText requiredMessage="5 - Code Postal *" required="true" value="#{etudiantBean.codePostal}" class="form-control" id="codePostal"  type="text" />
                                          </div>
                                      </div>
                                      <div class="form-group ">
                                          <label for="telMobile" class="control-label col-lg-2">Tél <span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <h:inputText requiredMessage="6 - Tél *" required="true"  value="#{etudiantBean.numTel}" class="form-control" id="telMobile"  type="text" />
                                          </div>
                                      </div>
                                      <div class="form-group ">
                                          <label for="mail" class="control-label col-lg-2">Mail <span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <h:inputText requiredMessage="7 - Mail *" required="true" value="#{etudiantBean.mail}" class="form-control" id="mail"  type="text">
                                                 <f:validator binding="#{emailValidator}" />
                                              </h:inputText>
                                          </div>
                                      </div>
                                      <div class="form-group ">
                                          <label for="dateDeNaissance" class="control-label col-lg-2">Date De Naissance <span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <p:calendar styleClass="calendar" id="dateDeNaissance" yearRange="c-70:c+10"
												value="#{etudiantBean.dateDeNaissance}" effect="fold" required="true" navigator="true"
												required-message="9 - Date De Naissance * " />
                                          </div>
                                      </div>
                                      <div class="form-group ">
                                          <label for="FormationInitial" class="control-label col-lg-2">Formation Initial <span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <h:inputText requiredMessage="10 - Formation Initial *" required="true" value="#{etudiantBean.formationInitial}"  class="form-control" id="FormationInitial"  type="text" />
                                          </div>
                                      </div>
                                      <div class="form-group ">
                                          <label for="ecole" class="control-label col-lg-2">Ecole <span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <h:inputText requiredMessage="11 - Ecole *" required="true" value="#{etudiantBean.ecole}" class="form-control" id="ecole"  type="text" />
                                          </div>
                                      </div>
                                      <div class="form-group ">
                                          <label for="dateObtention" class="control-label col-lg-2">Année d'obtention du diplôme<span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <p:calendar yearRange="c-70:c+10" styleClass="calendar" id="dateObtention" 
												value="#{etudiantBean.dateObtention}" effect="fold" required="true" navigator="true"
												required-message="12 - Date Obtention * " />
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <div class="col-lg-offset-2 col-lg-10">
                                              <h:commandButton action="#{etudiantBean.addEtudiant}" update="@form" value="Save" class="btn btn-primary"/>
                                          </div>
                                      </div>
                                  </h:form>
                              </div>
                          </div>
                      </section>
                  </div>
              </div>
          </section>
          
          <!-- get etudiant by session  -->
        
          <div class="row">
               <div class="col-lg-12">
                      <section class="panel">
                          <header class="panel-heading">
                              Afficher la liste des étudiants par session 
                          </header>
                          <div class="panel-body">
                              <div class="form">
                                <h:form id="form7" class="form-validate form-horizontal">
									  <p:growl id="growl" showDetail="true" life="5000" /> 
                                      <div class="form-group ">
                                          <label for="session" class="control-label col-lg-2">Sessions <span class="required">*</span></label>
                                          <div class="col-lg-10">
                                              <h:selectOneMenu style="cursor:pointer; height:35px;width:75%;color:#797979;font-size:16px;" styleClass="selectpicker" 
												value="#{etudiantBean.idSession}">
												<p:ajax event="valueChange"
												listener="#{etudiantBean.getAllStudentsBySession}"
												update="@form" />
												<f:selectItem itemLabel="Sélectionnez Une Session"
													itemValue="#{null}" noSelectionOption="true" />
												<f:selectItems  value="#{etudiantBean.allSessions}" var="s"
													itemLabel="Session N°:#{s.idSession}, #{s.specialite.designation},Lieu : #{s.lieu}, Début:#{s.dateDebute} ,(#{s.etatSession})"
													itemValue="#{s.idSession}" />
											</h:selectOneMenu>
                                          </div>
                                      </div>
									
								<br />
								<br />
								<c:if test="#{fn:length(etudiantBean.etudiants) >0 }">
									<div align="center">
										<p:dataTable var="newStudents" value="#{etudiantBean.etudiants}"
											id="studentTable"
											paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
											paginator="true" rows="10"  style="width:90%;margin-bottom:20px;">
					
											<f:facet name="{Exporters}">
												<p:commandLink ajax="false" style="float:right;"
													title="Fichier XML">
													<p:graphicImage name="NiceAdmin/img/xml.png" width="24" />
													<p:dataExporter type="xml" target=":form7:studentTable"
														fileName="Etudiants_Session_N°_#{etudiantBean.idSession}" />
												</p:commandLink>
					
												<p:commandLink ajax="false" style="float:right;"
													title="Fichier CSV">
													<p:graphicImage name="NiceAdmin/img/csv.png" width="24" />
													<p:dataExporter type="csv" target=":form7:studentTable"
														fileName="Etudiants_Session_N°_#{etudiantBean.idSession}" />
												</p:commandLink>
					
												<p:commandLink ajax="false" style="float:right;"
													title="Fichier PDF">
													<p:graphicImage name="NiceAdmin/img/pdf.png" width="24" />
													<p:dataExporter type="pdf" target=":form7:studentTable"
														fileName="Etudiants_Session_N°_#{etudiantBean.idSession}" />
												</p:commandLink>
					
												<p:commandLink ajax="false" style="float:right;"
													title="Fichier EXCEL">
													<p:graphicImage name="NiceAdmin/img/excel.png" width="24" />
													<p:dataExporter type="xls" target=":form7:studentTable"
														fileName="Etudiants_Session_N°_#{etudiantBean.idSession}" />
												</p:commandLink>
											</f:facet>
											<f:facet name="header">
												<h:outputText value="Liste Des Etudiants de la Session N° " />
												<h:outputText style="color:red;font-weight:bold;"
													value="#{etudiantBean.idSession}" />
											</f:facet>
											<p:column style="width:140px;">
												<f:facet name="header">
													<h:outputText value="Nom" />
												</f:facet>
												<h:outputText value="#{newStudents.nomEtudiant}" />
											</p:column>
											<p:column style="width:140px;">
												<f:facet name="header">
													<h:outputText value="Prénom" />
												</f:facet>
												<h:outputText value="#{newStudents.prenomEtudiant}" />
											</p:column>
											<p:column style="width:140px;">
												<f:facet name="header">
													<h:outputText value="Specialitee" />
												</f:facet>
												<h:outputText
													value="#{newStudents.sessionEtudiant.specialite.designation}" />
											</p:column>
											<p:column style="width:100px;">
												<f:facet name="header">
													<h:outputText value="Début" />
												</f:facet>
												<h:outputText value="#{newStudents.sessionEtudiant.dateDebute}" />
											</p:column>
											<p:column style="width:100px;">
												<f:facet name="header">
													<h:outputText value="Fin" />
												</f:facet>
												<h:outputText value="#{newStudents.sessionEtudiant.dateFin}" />
											</p:column>
											<p:column style="width:100px;">
												<f:facet name="header">
													<h:outputText value="Lieu" />
												</f:facet>
												<h:outputText value="#{newStudents.sessionEtudiant.lieu}" />
											</p:column>
										    <p:column style="width:80px;text-align:center;">
										       <f:facet name="header">
												 <h:outputText value="Actions" />
											   </f:facet>
										       <p:commandLink oncomplete="PF('carDialog').show()"
												update=":form7:moduleDetail"
												    title="Modifier">
												    <h:graphicImage name="NiceAdmin/img/pencil.png" style="width:20px;height:20px"></h:graphicImage>
													<f:param value="#{newStudents.idEtudiant}" name="idEtudiant"/>
													<f:param value="#{newStudents.sessionEtudiant.idSession}" name="idSession"/>
											        <p:ajax update=":form7:moduleDetail" event="click" listener="#{etudiantBean.getCurrentEtudiant(newStudents.idEtudiant)}"/>
												</p:commandLink> 
										    </p:column>
										</p:dataTable>
									</div>
								</c:if>
								<br />
								<br />
								
									<p:dialog header="Etudiant Info" widgetVar="carDialog"
											modal="true" showEffect="blind" hideEffect="explode"
											resizable="false" width="500px">
											<p:outputPanel id="moduleDetail" style="text-align:center;">
											      <c:if test="#{not empty etudiantBean.etudiant}">
														<h:inputHidden value="#{etudiantBean.etudiant.idEtudiant}" />
														<h:inputHidden value="#{etudiantBean.etudiant.sessionEtudiant.idSession}" />
														<h:outputText value="Nom Etudiant:" /><br/>
														<h:inputText value="#{etudiantBean.etudiant.nomEtudiant}" /><br/>
														<h:outputText value="Prénom Etdudiant" /><br/>
														<h:inputText value="#{etudiantBean.etudiant.prenomEtudiant}" /><br/>
														<h:outputText value="Date De Naissance" /><br/>
														<p:calendar value="#{etudiantBean.etudiant.dateDeNaissance}" /><br/>
														<h:outputText value="Formation Initial" /><br/>
														<h:inputText value="#{etudiantBean.etudiant.formationInitial}" /><br/>
														<h:outputText value="Ecole " /><br/>
														<h:inputText value="#{etudiantBean.etudiant.ecole}" /><br/>
														<h:outputText value="Date d'Obtention " /><br/>
														<p:calendar value="#{etudiantBean.etudiant.dateObtention}" /><br/>
														<h:outputText value="Adresse Postal" /><br/>
														<h:inputText value="#{etudiantBean.etudiant.adressePostal}" /><br/>
														<h:outputText value="Code Postal" /><br/>
														<h:inputText value="#{etudiantBean.etudiant.codePostal}" /><br/> 
														<h:outputText value="Tél" /><br/>
														<h:inputText value="#{etudiantBean.etudiant.numTel}" /><br/>
														<h:outputText value="Mail" /><br/>
														<h:inputText value="#{etudiantBean.etudiant.mail}" /><br/>
											 </c:if>
											</p:outputPanel>
											<br/>
							             <p:commandButton  value="Modifier" action="#{etudiantBean.edit}"/>
							            </p:dialog>
						           
							    </h:form>
                              </div>
                          </div>
                      </section>
               </div>
          </div> 
          </div>
         
         
</ui:composition>
</html>
